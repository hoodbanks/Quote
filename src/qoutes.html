<!doctype html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="./output.css" rel="stylesheet">
  <title>Daily Quotes</title>
</head>

<body class="h-full bg-gray-700 text-white font-sans antialiased">
  <div class="min-h-full flex items-center justify-center p-4">
    <div class="w-[380px] max-w-[92vw] min-h-[720px] rounded-[36px] bg-black/65 ring-1 ring-white/10 overflow-hidden relative">
      
      <div class="absolute inset-0 -z-10 bg-gradient-to-br from-brand-700 via-ink-900 to-black opacity-70"></div>
      <div class="absolute -left-40 -top-32 w-96 h-96 rounded-full bg-fuchsia-600/20 blur-3xl"></div>
      <div class="absolute -right-40 -bottom-24 w-96 h-96 rounded-full bg-indigo-500/20 blur-3xl">jn</div>

      
      <div class="h-6"></div>

   
      <header class="px-6 flex items-center justify-between">
        <h1 class="text-xl tracking-wide">
          <span class="font-semibold">Daily</span><span class="font-light"> Quotes</span>
        </h1>
        
      </header>

      <nav class="mt-5 px-6">
        <div class="flex gap-6 text-sm">
          <button id="tab-today" class="tab active relative pb-2">
            Today
            <span class="indicator absolute left-0 -bottom-[2px] h-[3px] w-full rounded-full bg-white/90"></span>
          </button>
          <button id="tab-favs" class="tab relative pb-2 text-white/60 hover:text-white">Favorites</button>
        </div>
      </nav>

      <!-- Cards area -->
      <main class="px-6 pt-6 pb-28">
       
        <div class="relative">
          <div class="absolute inset-x-2 top-4 h-[260px] rounded-3xl bg-white/5"></div>
          <div class="absolute inset-x-4 top-2 h-[260px]  bg-white/5"></div>

          <section id="today-card" class="relative rounded-3xl overflow-hidden backdrop-blur-md bg-white/10 ring-1 ring-white/15 p-5 min-h-[260px]">
            <div class="absolute inset-0 pointer-events-none bg-gradient-to-br from-fuchsia-500/35 via-indigo-500/25 to-sky-500/20"></div>

            <div class="relative z-10">
              <svg class="w-10 h-10 text-white/25" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M7.17 6A5.17 5.17 0 0 0 2 11.17V22h8V11.17A5.17 5.17 0 0 0 4.83 6H7.17zm12 0A5.17 5.17 0 0 0 14 11.17V22h8V11.17A5.17 5.17 0 0 0 19.83 6h-2.66z"/>
              </svg>

              <p id="q-text" class="mt-3 text-[20px] leading-8 font-medium">
                Loading‚Ä¶
              </p>
              <p id="q-author" class="mt-3 text-right text-white/70 text-sm">‚Äî</p>

              <div class="mt-6 flex items-center gap-3">
                <button id="btn-like" class="group inline-flex items-center justify-center w-11 h-11 rounded-full bg-white text-pink-600 hover:scale-[1.03] transition drop-shadow-glow" title="Save">
                 <p  class="w-6 h-6">Fav</p>
                </button>
                <button id="btn-share" class="inline-flex items-center justify-center w-11 h-11 rounded-full bg-white/90 text-indigo-700 hover:bg-white transition" title="Share">
                  <p class="w-60 h-6" >Share</p>
                <button id="btn-next" class="ml-auto inline-flex items-center justify-center px-4 h-11 rounded-full bg-indigo-600 hover:bg-indigo-700 transition">
                  New Quote
                </button>
              </div>
            </div>
          </section>

          <!-- Favorites list -->
          <section id="favs-list" class="hidden">
            <div id="empty-favs" class="rounded-3xl bg-white/5 ring-1 ring-white/10 p-6 text-white/70">
              No favorites yet. Tap the Fav to save quotes.
            </div>
            <div id="fav-items" class="space-y-4"></div>
          </section>
        </div>
      </main>

      <!-- Bottom nav -->
      <footer class="absolute bottom-0 inset-x-0 px-6 pb-6 pt-4 bg-gradient-to-t from-black/60 to-transparent">
        <div class="rounded-2xl bg-black/50 border border-white/10 p-3 flex items-center justify-around">
          <button id="bn-today" class="flex flex-col items-center gap-1 text-xs">
            <span class="w-6 h-6 inline-flex items-center justify-center rounded bg-white/90 text-black">üè†</span>
            Today
          </button>
          <button id="bn-favs" class="flex flex-col items-center gap-1 text-xs text-white/70">
            <span class="w-6 h-6 inline-flex items-center justify-center rounded bg-white/10">‚òÖ</span>
            Favorites
          </button>
        </div>
      </footer>
    </div>
  </div>

  <script>
    // my ls key
    const LS_KEY  = 'qutoz_favs_v1';

    
    const tabToday  = document.getElementById('tab-today');
    const tabFavs   = document.getElementById('tab-favs');
    const todayCard = document.getElementById('today-card');
    const favsList  = document.getElementById('favs-list');
    const emptyFavs = document.getElementById('empty-favs');
    const favItems  = document.getElementById('fav-items');

    const qText   = document.getElementById('q-text');
    const qAuthor = document.getElementById('q-author');
    const btnNext = document.getElementById('btn-next');
    const btnLike = document.getElementById('btn-like');
    const btnShare= document.getElementById('btn-share');

    const bnToday = document.getElementById('bn-today');
    const bnFavs  = document.getElementById('bn-favs');

    let current = null;

    //  Storage 
    const getFavs = () => {
      try { return JSON.parse(localStorage.getItem(LS_KEY)) || []; }
      catch { return []; }
    }
    const setFavs = (arr) => localStorage.setItem(LS_KEY, JSON.stringify(arr));
    const isSaved = (id) => getFavs().some(q => q._id === id);

    
    function switchTab(which) {
      const toFavs = which === 'favs';

      // tabs
      [tabToday, tabFavs].forEach(t => {
        t.classList.remove('text-white','active');
        t.classList.add('text-white/60');
        t.querySelector('.indicator')?.remove();
      });
      const active = toFavs ? tabFavs : tabToday;
      active.classList.remove('text-white/60'); active.classList.add('text-white','active');
      const bar = document.createElement('span');
      bar.className = 'indicator absolute left-0 -bottom-[2px] h-[3px] w-full rounded-full bg-white/90';
      active.appendChild(bar);

     
      todayCard.classList.toggle('hidden', toFavs);
      favsList.classList.toggle('hidden', !toFavs);

      
      bnToday.classList.toggle('text-white/70', toFavs===true);
      bnFavs.classList.toggle('text-white/70', toFavs===false);
    }

    function setLikeState() {
      if (!current) return;
      btnLike.style.opacity = isSaved(current._id) ? 0.6 : 1;
    }

    function toast(button, label='Done', ms=900) {
      const prev = button.innerText;
      button.innerText = label;
      button.disabled = true;
      setTimeout(()=>{ button.innerText = prev; button.disabled = false; }, ms);
    }

   
    const timeout = (ms) => new Promise((_, rej) => setTimeout(()=>rej(new Error('timeout')), ms));
    async function fetchJSON(url, ms=6000) {
      const res = await Promise.race([ fetch(url, { cache:'no-store' }), timeout(ms) ]);
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      return res.json();
    }

   
    const providers = [
    
  async () => {
  const d = await fetchJSON('https://dummyjson.com/quotes/random');
  return { _id: String(d.id ?? crypto.randomUUID()), content: d.quote, author: d.author || 'Unknown' };
},
  
    ];

    const OFFLINE_QUOTES = [
      { _id:'o1', content:'The secret of getting ahead is getting started.', author:'Mark Twain' },
      { _id:'o2', content:'It always seems impossible until it‚Äôs done.', author:'Nelson Mandela' },
      { _id:'o3', content:'You miss 100% of the shots you don‚Äôt take.', author:'Wayne Gretzky' },
    ];

    async function loadQuote() {
      qText.textContent = 'Loading‚Ä¶';
      qAuthor.textContent = '‚Äî';
      btnNext.disabled = true;

      for (let i = 0; i < providers.length; i++) {
        try {
          const q = await providers[i]();
          current = q;
          qText.textContent = `‚Äú${q.content}‚Äù`;
          qAuthor.textContent = `‚Äî ${q.author}`;
          setLikeState();
          btnNext.disabled = false;
          return;
        } catch (e) {
          await new Promise(r => setTimeout(r, 300));
        }
      }

      // 4 offline
      const q = OFFLINE_QUOTES[Math.floor(Math.random()*OFFLINE_QUOTES.length)];
      current = q;
      qText.textContent = `‚Äú${q.content}‚Äù`;
      qAuthor.textContent = `‚Äî ${q.author} (offline)`;
      btnNext.disabled = false;
      setLikeState();
    }

    //4 my  Fav
    function renderFavs() {
      const favs = getFavs();
      favItems.innerHTML = '';
      emptyFavs.classList.toggle('hidden', favs.length > 0);

      favs.forEach(q => {
        const card = document.createElement('div');
        card.className = 'relative rounded-3xl overflow-hidden backdrop-blur bg-white/10 ring-1 ring-white/15 p-5';
        card.innerHTML = `
          <div class="absolute inset-0 bg-gradient-to-br from-fuchsia-500/25 via-indigo-500/20 to-sky-500/15"></div>
          <div class="relative">
            <p class="text-[18px] leading-7">‚Äú${q.content}‚Äù</p>
            <p class="mt-2 text-right text-white/70 text-sm">‚Äî ${q.author}</p>
            <div class="mt-4 flex gap-2">
              <button data-id="${q._id}" class="copy inline-flex items-center justify-center px-3 h-9 rounded-full bg-white/90 text-indigo-700">Copy</button>
              <button data-id="${q._id}" class="remove inline-flex items-center justify-center px-3 h-9 rounded-full bg-red-600">Delete</button>
            </div>
          </div>
        `;
        favItems.appendChild(card);
      });

     
      favItems.querySelectorAll('button.copy').forEach(b=>{
        b.addEventListener('click', ()=>{
          const id = b.getAttribute('data-id');
          const q = getFavs().find(x => x._id===id);
          if (q) {
            navigator.clipboard.writeText(`"${q.content}" ‚Äî ${q.author}`);
            toast(b,'Copied');
          }
        })
      });
      favItems.querySelectorAll('button.remove').forEach(b=>{
        b.addEventListener('click', ()=>{
          const id = b.getAttribute('data-id');
          setFavs(getFavs().filter(x=>x._id!==id));
          renderFavs();
          setLikeState();
        })
      });
    }

    function saveCurrent() {
      if (!current) return;
      if (isSaved(current._id)) return toast(btnLike, 'Saved');
      const list = getFavs();
      list.unshift({ ...current, savedAt: Date.now() });
      setFavs(list);
      setLikeState();
      toast(btnLike, 'Saved');
    }

    //s 
    async function shareCurrent() {
      if (!current) return;
      const text = `"${current.content}" ‚Äî ${current.author}`;
      if (navigator.share) {
        try { await navigator.share({ text }); } catch {}
      } else {
        await navigator.clipboard.writeText(text);
        toast(btnShare, 'Copied');
      }
    }

    //evnt actions
    btnNext.addEventListener('click', loadQuote);
    btnLike.addEventListener('click', saveCurrent);
    btnShare.addEventListener('click', shareCurrent);

    tabToday.addEventListener('click', ()=>switchTab('today'));
    tabFavs.addEventListener('click', ()=>{ switchTab('favs'); renderFavs(); });

    bnToday.addEventListener('click', ()=>switchTab('today'));
    bnFavs.addEventListener('click', ()=>{ switchTab('favs'); renderFavs(); });

    // ---------- Init ----------
    switchTab('today');
    loadQuote();
  </script>
</body>
</html>